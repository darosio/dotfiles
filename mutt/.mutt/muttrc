# Inspired by:
# https://pbrisbin.com/posts/two_accounts_in_mutt/ (espacially the git repo.)
# http://stevelosh.com/blog/2012/10/the-homely-mutt/

set mailcap_path        = ~/.mutt/mailcap			# entrys for filetypes
set sleep_time = 0
set send_charset="utf-8"
#auto_view text/html
set sort=threads
set sort_aux=last-date-received
set query_command="goobook query %s"
macro index,pager a "<pipe-message>goobook add<return>" "add sender to google contacts"
bind editor <Tab> complete-query

## Receive options.
set mbox_type=Maildir
set folder=$HOME/.maildir/
set mask="!^\\.[^.]"
# Store message headers locally to speed things up.
# If hcache is a folder, Mutt will create sub cache folders for each account which may speeds things up even more.
set header_cache = ~/.cache/mutt/
#
#set imap_check_subscribed
mailboxes `echo -n "+ "; find ~/.maildir/ -maxdepth 1 -type d -name "*" -printf "+'%f' "`

#
# Sync email
macro index O "<shell-escape>mbsync -a<enter>"           "run offlineimap to sync all mail"
macro index o "<shell-escape>mbsync -n -d INBOXES<enter>" "run offlineimap to sync inbox"

# hooks for multiaccount
set spoolfile = "+cnr/Inbox"
folder-hook cnr/*		'source ~/.mutt/cnr'
folder-hook gmail/*     'source ~/.mutt/gmail'
source ~/.mutt/cnr
#
## ACCOUNT2
#source "~/.mutt/gmail"
#folder-hook danielepietroarosio@gmail.com/ 'source ~/.mutt/gmail'
##folder-hook *danielepietriarosio@gmail.com/Family 'set realname="Dan"'

## ACCOUNT1
##source "~/.mutt/cnr"
# Here we use the $folder variable that has just been set in the sourced file.
# We must set it right now otherwise the 'folder' variable will change in the next sourced file.
##folder-hook $folder 'source ~/.mutt/cnr'
macro index C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index c "<change-folder>?<toggle-mailboxes>" "copy a message to a mailbox"
macro pager c "<change-folder>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"
macro compose A "<attach-message>?<toggle-mailboxes>" "attach message(s) to this message"
macro index 'c' '<change-folder>?<change-dir><home>^K=<enter>'
macro index,pager <f2> '<sync-mailbox><enter-command>source ~/.mutt/cnr<enter><change-folder>!<enter>'
macro index,pager <f3> '<sync-mailbox><enter-command>source ~/.mutt/gmail<enter><change-folder>!<enter>'
macro attach 'V' "<pipe-entry>cat >~/.cache/mutt/mail.html && $BROWSER ~/.cache/mutt/mail.html && rm ~/.cache/mutt/mail.html<enter>"
source ~/.mutt/colors
source ~/.mutt/bindings
#set pager_index_lines=10
source ~/.mutt/sidebar
